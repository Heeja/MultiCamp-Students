## 웹보안

다음과 같은 기능의 웹 서비스(페이지)를 개발할 때 발생할 수 있는 보안취약점과 대응 방법에 대해 기술하시오.   

* 기능1. 로그인 화면
  * 사용자에게 사용자 ID와 패스워드를 입력할 수 있도록 입력창을 제공한다.
  * 사용자에게 로그인 버튼을 제공하고, 로그인 버튼을 클릭하면 웹 서버로 로그인 처리(기능2)를 요청한다. 
* 기능2. 로그인 처리
  - 요청 파라미터로 전달된 사용자 ID, 패스워드와 일치하는 정보가 사용자 정보 테이블에 존재하는지 조회한다.
  - 조회 결과가 있으면 메인 페이지로 리다이렉트 한다.
  - 조회 결과가 없으면 로그인 실패 메시지와 함께 로그인 화면(기능1)을 반환한다.
  - 실패 메시지의 형태는 “일치하는 ‘사용자 ID’가 존재하지 않습니다.” 이다.

### 취약점

- ID,PW 입력 창에 SQL Injection 공격을 시도할 수 있다.
- ID,PW 입력 창에 Script 구문을 입력하여 공격을 시도할 수 있다.
- 로그인 버튼 입력 후 ID,PW 입력 값을 로그인 이후의 페이지에서 사용, 확인 될 수 있다.
- 로그인 실패 메시지를 통해서 등록된 ID를 유추해 낼 수 있다.
- 로그인 ID/PW 조회만 하여 로그인 처리를 하는 것에 위험이 있으며, 이후 사용할 게시물 등록, 파일 업로드 페이지에 대해서 사용자 인증이 되지 않을 수 있어 다시 로그인 하는 번거로움이 발생할 수 있다. 또 다시 로그인을 반복한다면 사용자 ID/PW가 노출될 위험이 높아진다.

### 대응 방법

- ID, PW의 입력 창에 SQL문이 수정되는 문자(특수문자, 각 DB프로그램의 주석문자 등)이 입력되지 않도록 서버에서 입력 값을 검증하여 처리한다.
- ID, PW 입력 창에 Script 구문이 입력 되어도 실행되지 않도록 하기 위해 서버에서 입/출력 값에 대해 필터링 해야 한다.
  오픈소스 라이브러리(lucy-xss filter 등)을 사용하여 일일이 특수문자, URL 인코딩 문자 등을 필터링 하지 않고 더 많은 방법의 XSS 공격 문자들을 필터링 할 수 있다.
- 입력된 PW의 평문 값을 서버의 독립된 파일이나, DB 서버의 개별적인 테이블에 따로 저장하고 파일이나 DB의 테이블을 열람 할 수 있는 권한을 제한하며, 저장되는 PW의 값은 해시코드로 변환하여 쉽게 PW를 알아내지 못하도록 한다.
  해시함수는 일방향 함수로 해시값을 통해 해시처리한 문자열을 알아내는 것이 매우매우 어렵다.
- 로그인 버튼을 누른 후 입력된 값이 다시 사용할 수 없도록 서버에 전송 후 값은 초기화 또는 삭제되도록 한다.
- 로그인 실패 메시지를 통해서 ID를 유추한 후 로그인을 여러번 시도해볼 수 없도록 로그인 시도 횟수에 제한을 두도록 한다.
- 사용자 브라우저의 쿠키와 서버에서의 세션정보를 이용하여 ID/PW의 노출빈도를 줄인다.





## 취약점 제거를 위한 시큐어코딩
다음과 같은 기능의 웹 서비스(페이지)를 개발할 때 발생할 수 있는 보안 취약점과 대응 방법에 대해 기술하시오.

* 기능1. 게시판 글쓰기
  * 사용자에게 게시판 제목, 내용, 첨부파일을 입력할 수 있도록 입력창을 제공한다.
  * 사용자에게 글저장 버튼을 제공하고, 글저장 버튼을 클릭하면 서버로 게시판 글저장(기능2)을 요청한다.
* 기능2. 게시판 글저장
  * 요청 파라미터로 전달된 게시판 제목, 내용과 첨부파일 이름을 게시판 정보 테이블에 저장한다.
  * 첨부파일은 WebRoot 아래 upload_file 디렉터리에 저장한다. 
* 기능3. 게시판 글보기
  * 게시판 정보 테이블에 저장된 제목, 내용, 첨부파일 이름을 보여준다. 
  * 사용자가 첨부파일 이름을 클릭하면 업로드한 파일을 내려 받을 수 있다.

## 취약점

* 제목, 내용 입력 창을 통해서 SQL 삽입 공격을 시도 할 수 있다.
* 제목, 내용 입력 창에 스크립트 코드를 삽입하여 다른 사용자들이 게시글을 읽으면 스크립트 코드가 실행되는 공격을 시도 할 수 있다.
* 첨부파일 용량을 제한하지 않으면 서버 자원을 낭비시키는 공격을 받을 수 있다.
* 스크립트 코드를 삽입한 첨부파일을 업로드하여 서버에서 스크립트가 실행되는 공격을 받을 수 있다.
* 스크립트 코드를 삽입한 첨부파일을 업로드하여 게시물을 등록하고 게시물을 통해 스크립트 코드가 삽입된 파일을 퍼트려 공격할 수 있다.
* 서버주소/upload_file 을 입력하여 서버에 접근해 볼 수 있는 위험성을 가지고 있다.

## 대응 방법

* 제목, 내용 입력 문자열에 SQL문을 변경할 수 있는 문자는 필터링 한다.
* 제목, 내용 입력 문자열에 스크립트 코드로 사용될 수 있는 문자열을 필터링하여 자동으로 실행되는 스크립트 코드를 막는다.
* 첨부파일 확장자를 필터링 하여 첨부파일 종류는 제한한다.
* 업로드 가능한 첨부파일 용량을 제한하여 서버 자원 낭비를 막는다.
* 첨부파일의 확장자 명을 제거하거나, 실행 가능한 파일이 아니도록 변환하여 저장해 스크립트 실행을 막는다.
* URL 주소를 변환하여 입력하여도 upload_file에는 접근하지 못하도록 제한하며, 에러가 발생하더라도 별도의 에러페이지를 만들어 에러코드를 노출하지 않도록 한다.



* 평가기준
  1. 입력값 검증의 필요성과 방법을 알고 있다.
  2. SQL 삽입 취약점을 이해하고 대응 방법을 알고 있다.
  3. 패스워드 암호화 기법과 패스워드 검증 방법을 알고 있다.
  4. 안전한 인증 방식과 세션 ID 관리 방법을 알고 있다.
  5. 반사 XSS 취약점을 이해하고 대응 방법을 알고 있다.
  6. 인증시도회수제한의 필요성과 적용 방법을 알고 있다.
  7. 민감한 데이터 노출 취약점을 이해하고 대응 방법을 알고 있다.
  8. SQL 삽입 취약점을 이해하고 대응 방법을 알고 있다.
  9. 파일 업로드 취약점을 이해하고 대응 방법을 알고 있다.
  10. 파일 다운로드 취약점을 이해하고 대응 방법을 알고 있다.
  11. 저장 XSS 취약점을 이해하고 대응 방법을 알고 있다.
  12. 크로스 사이트 요청 위조 취약점을 이해하고 대응 방법을 알고 있다.